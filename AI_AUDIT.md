# DeadLine - –ê—É–¥–∏—Ç AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

## –û–±–∑–æ—Ä
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: GigaChat (Sber), OpenAI, –∏ LangChain –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏. –û—Å–Ω–æ–≤–Ω–æ–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç "–í–∞—Å–∏–ª–∏–π" —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### ü§ñ –û—Å–Ω–æ–≤–Ω—ã–µ AI —Å–µ—Ä–≤–∏—Å—ã

#### 1. GigaChatService (`src/lib/ai/gigachat.ts`)
**–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** Sber GigaChat
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ß–µ—Ä–µ–∑ environment variables
- **–ú–æ–¥–µ–ª—å:** GigaChat:latest (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:** –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –¥–ª—è –í–∞—Å–∏–ª–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∫–æ–º–∞–Ω–¥—ã

#### 2. GigaChatService (`src/lib/ai/gigachat-service.ts`)
**–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** Sber GigaChat
- **–§—É–Ω–∫—Ü–∏–∏:** –ê–Ω–∞–ª–∏–∑ –æ–ø—ã—Ç–∞, –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏—è, —ç–º–æ—Ü–∏–∏, —Ä–∏—Å–∫–∏
- **JSON –ø–∞—Ä—Å–∏–Ω–≥:** –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è JSON
- **Fallback:** Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

#### 3. OpenAIService (`src/lib/ai/openai-service.ts`)
**–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** OpenAI
- **–ú–æ–¥–µ–ª—å:** GPT-4o-mini + text-embedding-3-small
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** LangChain –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
- **–§—É–Ω–∫—Ü–∏–∏:** Embeddings, —á–∞—Ç, –∞–Ω–∞–ª–∏–∑ –∑–∞–¥–∞—á

#### 4. VasilyService (`src/lib/ai/vasily-service.ts`)
**–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** GigaChat (–æ—Å–Ω–æ–≤–Ω–æ–π) + OpenAI (–∑–∞–ø–∞—Å–Ω–æ–π)
- **–†–æ–ª—å:** –û—Å–Ω–æ–≤–Ω–æ–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç–∞
- **–§—É–Ω–∫—Ü–∏–∏:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏, –∞–Ω–∞–ª–∏–∑, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ GigaChat –∫–ª–∏–µ–Ω—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–≤–∞ —Ä–∞–∑–Ω—ã—Ö GigaChatService –∫–ª–∞—Å—Å–∞
- `gigachat.ts` - –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
- `gigachat-service.ts` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

**–†–∏—Å–∫:** –ö–æ–¥ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –µ–¥–∏–Ω—ã–π —Å–µ—Ä–≤–∏—Å

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ circuit breaker –ø–∞—Ç—Ç–µ—Ä–Ω–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç cascade failures AI API
```typescript
// –í—Å–µ –≤—ã–∑–æ–≤—ã - fire-and-forget –±–µ–∑ fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
const response = await this.callGigaChat(prompt);
```

#### 3. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π JSON –ø–∞—Ä—Å–∏–Ω–≥
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ regex –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è JSON
```typescript
// src/lib/ai/gigachat-service.ts:311
const jsonMatch = response.match(/\{[\s\S]*\}/);
if (jsonMatch) {
  return JSON.parse(jsonMatch[0]); // –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è
}
```

#### 4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –¥–ª—è AI –≤—ã–∑–æ–≤–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –≤—ã–∑–æ–≤–æ–≤ AI API

### üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 5. Hardcoded AI prompts
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–¥–µ
- –°–ª–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- –ù–µ—Ç versioning –ø—Ä–æ–º–ø—Ç–æ–≤

#### 6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ AI response caching
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ AI –Ω–µ –∫–µ—à–∏—Ä—É—é—Ç—Å—è
**–ü—Ä–∏–º–µ—Ä:** –ê–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑

#### 7. –ù–µ—Ç –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ AI API usage, costs, performance

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤

### GigaChat –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### ‚úÖ –•–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
- Graceful fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ (—á–∞—Ç, –∞–Ω–∞–ª–∏–∑, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)

#### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã:
```typescript
// –†–∞–∑–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –¥–≤—É—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
// gigachat.ts
baseUrl: 'https://gigachat.devices.sberbank.ru/api/v1'

// gigachat-service.ts  
baseUrl: 'https://gigachat.devices.sberbank.ru/api/v1' // –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### OpenAI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### ‚úÖ –•–æ—Ä–æ—à–æ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LangChain –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ embeddings
- Type-safe –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

#### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã:
- –ù–µ—Ç fallback –Ω–∞ GigaChat –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ OpenAI
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ cost tracking

### Vasily AI Assistant

#### ‚úÖ –•–æ—Ä–æ—à–æ:
- –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è —Ä–æ–ª—å –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞
- –†–∞–∑–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

#### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã:
- Memory management –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- –ù–µ—Ç conversation persistence –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- Hardcoded personality traits

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (Critical)
1. **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å GigaChat —Å–µ—Ä–≤–∏—Å—ã** –≤ –µ–¥–∏–Ω—ã–π –∫–ª–∞—Å—Å
2. **–î–æ–±–∞–≤–∏—Ç—å circuit breaker** –¥–ª—è AI API calls
3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å JSON –ø–∞—Ä—Å–∏–Ω–≥** —Å proper validation
4. **–î–æ–±–∞–≤–∏—Ç—å rate limiting** –¥–ª—è AI endpoints

### –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (High)
1. **–í—ã–Ω–µ—Å—Ç–∏ –ø—Ä–æ–º–ø—Ç—ã** –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
2. **–î–æ–±–∞–≤–∏—Ç—å AI response caching** (Redis/Memory)
3. **–í–Ω–µ–¥—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI (costs, latency, success rate)

### –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Medium)
1. **AI failover —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** (GigaChat ‚Üí OpenAI ‚Üí cached responses)
2. **Prompt versioning** –∏ A/B testing
3. **AI performance monitoring** dashboard

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ AI –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
AI Service Layer
‚îú‚îÄ‚îÄ Core AI Client (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π GigaChat/OpenAI)
‚îú‚îÄ‚îÄ Circuit Breaker
‚îú‚îÄ‚îÄ Rate Limiter  
‚îú‚îÄ‚îÄ Cache Layer
‚îú‚îÄ‚îÄ Metrics Collector
‚îî‚îÄ‚îÄ Prompt Manager

AI Features
‚îú‚îÄ‚îÄ Vasily Assistant
‚îú‚îÄ‚îÄ Task Analysis
‚îú‚îÄ‚îÄ Code Generation
‚îú‚îÄ‚îÄ Documentation
‚îî‚îÄ‚îÄ Predictive Analytics
```

## –†–∏—Å–∫–∏ –∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

### üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏:
1. **API downtime cascade** - –±–µ–∑ circuit breaker –≤–µ—Å—å —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å
2. **Cost overrun** - –±–µ–∑ rate limiting –≤–æ–∑–º–æ–∂–µ–Ω unlimited usage
3. **Data corruption** - –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π JSON –ø–∞—Ä—Å–∏–Ω–≥ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

### ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏:
1. **Poor user experience** - –º–µ–¥–ª–µ–Ω–Ω—ã–µ AI –æ—Ç–≤–µ—Ç—ã –±–µ–∑ caching
2. **Maintenance complexity** - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ —Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
3. **Debugging difficulty** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç—Ä–∏–∫ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç troubleshooting

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:** 2 (GigaChat, OpenAI)
- **AI —Å–µ—Ä–≤–∏—Å–æ–≤:** 4+ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ GigaChat)
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 4
- **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 3
- **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 4

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ critical –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. –°–æ–∑–¥–∞—Ç—å unified AI client architecture
3. –î–æ–±–∞–≤–∏—Ç—å comprehensive AI monitoring
4. –í–Ω–µ–¥—Ä–∏—Ç—å AI performance optimization (caching, batching)
5. –°–æ–∑–¥–∞—Ç—å AI usage dashboard –¥–ª—è costs –∏ performance tracking
